generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id             String             @id @default(uuid()) @db.Uuid
  email          String?            @unique
  name           String
  passwordHash   String             @map("password_hash")
  createdAt      DateTime           @default(now()) @map("created_at") @db.Timestamptz(3)
  updatedAt      DateTime           @updatedAt @map("updated_at") @db.Timestamptz(3)
  age            Int?
  isVerified     Boolean            @default(false) @map("is_verified")
  mobile         String             @unique
  otp            String?
  otpExpiresAt   DateTime?          @map("otp_expires_at")
  role           UserRole           @default(USER)
  decidedCases   DisciplinaryCase[] @relation("DecidedCases")
  initiatedCases DisciplinaryCase[] @relation("InitiatedCases")
  reviewedCases  DisciplinaryCase[] @relation("ReviewedCases")
  projects       Project[]

  @@index([mobile])
  @@index([email])
  @@index([createdAt])
  @@map("users")
}

model VisitorStats {
  id            String   @id @default(uuid()) @db.Uuid
  totalVisitors Int      @default(0) @map("total_visitors")
  updatedAt     DateTime @updatedAt @map("updated_at") @db.Timestamptz(3)

  @@map("visitor_stats")
}

model Project {
  id          String        @id @default(uuid()) @db.Uuid
  name        String
  description String?
  status      ProjectStatus @default(ACTIVE)
  ownerId     String        @map("owner_id") @db.Uuid
  createdAt   DateTime      @default(now()) @map("created_at") @db.Timestamptz(3)
  updatedAt   DateTime      @updatedAt @map("updated_at") @db.Timestamptz(3)
  owner       User          @relation(fields: [ownerId], references: [id], onDelete: Cascade)

  @@index([ownerId])
  @@index([status])
  @@index([createdAt])
  @@map("projects")
}

model Atrocity {
  id           String       @id @default(uuid()) @db.Uuid
  leaderName   String       @map("leader_name") @db.VarChar(100)
  position     String?      @db.VarChar(100)
  description  String
  images       String[]
  createdAt    DateTime     @default(now()) @map("created_at") @db.Timestamptz(3)
  updatedAt    DateTime     @updatedAt @map("updated_at") @db.Timestamptz(3)
  constituency String       @db.VarChar(50)
  district     String       @db.VarChar(50)
  isVerified   Boolean      @default(false) @map("is_verified")
  mandal       String       @db.VarChar(50)
  state        String       @db.VarChar(50)
  village      String?      @db.VarChar(50)
  atrocityBy   String?      @map("atrocity_by") @db.VarChar(100)
  atrocityType AtrocityType @default(TO_JSP_LEADER) @map("atrocity_type")
  subject      String?      @db.VarChar(200)

  @@index([createdAt])
  @@index([isVerified])
  @@index([state])
  @@map("atrocities")
}

model Leader {
  id                String       @id @default(uuid()) @db.Uuid
  name              String       @db.VarChar(100)
  district          String       @db.VarChar(50)
  mandal            String?      @db.VarChar(50)
  reason            String
  serviceAreas      String[]
  values            String[]
  photo             String?
  submittedBy       SubmittedBy  @map("submitted_by")
  status            LeaderStatus @default(PENDING)
  adminNotes        String?      @map("admin_notes")
  createdAt         DateTime     @default(now()) @map("created_at") @db.Timestamptz(3)
  updatedAt         DateTime     @updatedAt @map("updated_at") @db.Timestamptz(3)
  gallery           String[]
  nominatedPost     String?
  otherPlatforms    Json?
  partyPosition     String?
  partyYears        Int?
  primaryPlatform   String?
  primaryProfileUrl String?

  @@index([status])
  @@index([district])
  @@index([createdAt])
  @@map("leaders")
}

model SocialMediaWarrior {
  id                   String        @id @default(uuid()) @db.Uuid
  name                 String        @db.VarChar(100)
  district             String        @db.VarChar(50)
  mandal               String?       @db.VarChar(50)
  reason               String
  digitalContributions String[]
  engagementStyle      String[]
  photo                String?
  gallery              String[]
  partyYears           Int?
  partyPosition        String?
  nominatedPost        String?
  primaryPlatform      String?
  primaryProfileUrl    String?
  otherPlatforms       Json?
  submittedBy          SubmittedBy   @map("submitted_by")
  status               WarriorStatus @default(PENDING)
  adminNotes           String?       @map("admin_notes")
  createdAt            DateTime      @default(now()) @map("created_at") @db.Timestamptz(3)
  updatedAt            DateTime      @updatedAt @map("updated_at") @db.Timestamptz(3)

  @@index([status])
  @@index([district])
  @@index([createdAt])
  @@map("social_media_warriors")
}

model GovernanceHighlight {
  id            String            @id @default(uuid()) @db.Uuid
  title         String            @db.VarChar(200)
  category      HighlightCategory
  description   String
  area          String            @db.VarChar(100)
  department    String?           @db.VarChar(100)
  state         String            @db.VarChar(50)
  district      String            @db.VarChar(50)
  constituency  String?           @db.VarChar(50)
  mandal        String?           @db.VarChar(50)
  village       String?           @db.VarChar(50)
  yearStarted   Int?
  yearCompleted Int
  period        String?           @db.VarChar(50)
  status        HighlightStatus   @default(ADDRESSED)
  sourceType    SourceType
  sourceUrl     String            @db.VarChar(500)
  sourceTitle   String?           @db.VarChar(200)
  issueContext  String?
  image         String?
  isVerified    Boolean           @default(false) @map("is_verified")
  isVisible     Boolean           @default(true) @map("is_visible")
  adminNotes    String?           @map("admin_notes")
  createdAt     DateTime          @default(now()) @map("created_at") @db.Timestamptz(3)
  updatedAt     DateTime          @updatedAt @map("updated_at") @db.Timestamptz(3)
  gallery       String[]

  @@index([category])
  @@index([isVerified])
  @@index([isVisible])
  @@index([yearCompleted])
  @@index([state])
  @@index([district])
  @@map("governance_highlights")
}

model DisciplinaryCase {
  id                    String         @id @default(uuid()) @db.Uuid
  caseNumber            String         @unique @map("case_number") @db.VarChar(50)
  leaderName            String         @map("leader_name") @db.VarChar(100)
  position              String         @db.VarChar(100)
  constituency          String?        @db.VarChar(50)
  issueCategory         IssueCategory  @map("issue_category")
  issueDescription      String         @map("issue_description")
  issueSource           IssueSource    @map("issue_source")
  initiationDate        DateTime       @default(now()) @map("initiation_date") @db.Timestamptz(3)
  reviewStartDate       DateTime?      @map("review_start_date") @db.Timestamptz(3)
  decisionDate          DateTime?      @map("decision_date") @db.Timestamptz(3)
  effectiveFrom         DateTime?      @map("effective_from") @db.Timestamptz(3)
  effectiveTo           DateTime?      @map("effective_to") @db.Timestamptz(3)
  initiatedBy           String         @map("initiated_by") @db.Uuid
  reviewAuthority       String?        @map("review_authority") @db.Uuid
  decisionAuthority     String?        @map("decision_authority") @db.Uuid
  status                CaseStatus     @default(UNDER_REVIEW)
  actionOutcome         ActionOutcome? @map("action_outcome")
  visibility            CaseVisibility @default(INTERNAL_ONLY)
  internalNotes         String?        @map("internal_notes")
  evidenceUrls          String[]       @map("evidence_urls")
  imageUrls             String[]       @map("image_urls")
  decisionRationale     String?        @map("decision_rationale")
  createdAt             DateTime       @default(now()) @map("created_at") @db.Timestamptz(3)
  updatedAt             DateTime       @updatedAt @map("updated_at") @db.Timestamptz(3)
  leaderPhotoUrl        String?        @map("leader_photo_url")
  sourceLinks           String[]       @map("source_links")
  district              String?        @db.VarChar(50)
  decisionAuthorityUser User?          @relation("DecidedCases", fields: [decisionAuthority], references: [id])
  initiatedByUser       User           @relation("InitiatedCases", fields: [initiatedBy], references: [id])
  reviewAuthorityUser   User?          @relation("ReviewedCases", fields: [reviewAuthority], references: [id])

  @@index([status])
  @@index([visibility])
  @@index([initiationDate])
  @@index([caseNumber])
  @@map("disciplinary_cases")
}

enum UserRole {
  USER
  ADMIN
  SUPER_ADMIN
}

enum ProjectStatus {
  ACTIVE
  ARCHIVED
  COMPLETED
  ON_HOLD

  @@map("project_status")
}

enum AtrocityType {
  TO_JSP_LEADER
  TO_JANASENA_PARTY

  @@map("atrocity_type")
}

enum LeaderStatus {
  PENDING
  APPROVED
  HIDDEN
  ARCHIVED

  @@map("leader_status")
}

enum SubmittedBy {
  SELF
  SUPPORTER
  ANONYMOUS

  @@map("submitted_by")
}

enum WarriorStatus {
  PENDING
  APPROVED
  HIDDEN
  ARCHIVED

  @@map("warrior_status")
}

enum HighlightCategory {
  INNOVATIVE_INITIATIVE
  PENDING_ISSUE_ADDRESSED

  @@map("highlight_category")
}

enum HighlightStatus {
  ADDRESSED
  IN_PROGRESS
  FOLLOW_UP_ONGOING

  @@map("highlight_status")
}

enum SourceType {
  GOVERNMENT_PORTAL
  PRESS_RELEASE
  PUBLIC_RECORD
  NEWS_REPORT
  FIELD_VERIFICATION

  @@map("source_type")
}

enum IssueCategory {
  MISCONDUCT
  POLICY_VIOLATION
  ETHICAL_BREACH
  INSUBORDINATION
  FINANCIAL_IRREGULARITY
  PUBLIC_STATEMENT_VIOLATION
  OTHER

  @@map("issue_category")
}

enum IssueSource {
  INTERNAL_COMPLAINT
  EXTERNAL_COMPLAINT
  MEDIA_REPORT
  PARTY_OBSERVATION
  LEGAL_NOTICE

  @@map("issue_source")
}

enum CaseStatus {
  UNDER_REVIEW
  CLARIFICATION_REQUIRED
  REVIEW_COMPLETED
  ACTION_TAKEN
  CLOSED
  ARCHIVED

  @@map("case_status")
}

enum ActionOutcome {
  NO_ACTION
  WARNING
  TEMPORARY_SUSPENSION
  PERMANENT_SUSPENSION
  POSITION_REVOKED
  MEMBERSHIP_REVOKED

  @@map("action_outcome")
}

enum CaseVisibility {
  INTERNAL_ONLY
  PUBLIC
  RESTRICTED

  @@map("case_visibility")
}
